<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>JARVIS AI Assistant</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #000;
      overflow-x: hidden;
      color: #fff;
    }

    /* Animated Background */
    .bg-animation {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 20% 20%, #001122 0%, #000611 50%, #000 100%);
      z-index: -2;
    }

    .bg-animation::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 80% 20%, rgba(0, 150, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 20% 80%, rgba(0, 255, 150, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255, 0, 150, 0.1) 0%, transparent 50%);
      animation: backgroundPulse 4s ease-in-out infinite;
    }

    @keyframes backgroundPulse {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 0.6; }
    }

    /* Preloader */
    .preloader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease-out;
    }

    .preloader.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .loader-circle {
      width: 80px;
      height: 80px;
      border: 3px solid rgba(0, 150, 255, 0.3);
      border-top: 3px solid #0096ff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .loader-text {
      font-size: 18px;
      color: #0096ff;
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    /* Language Selection */
    .language-selection {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      transition: opacity 0.5s ease-out;
    }

    .language-selection.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .lang-title {
      font-size: 32px;
      margin-bottom: 40px;
      background: linear-gradient(45deg, #0096ff, #00ff96);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-align: center;
    }

    .lang-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      max-width: 800px;
    }

    .lang-btn {
      padding: 15px 30px;
      background: rgba(0, 150, 255, 0.1);
      border: 2px solid #0096ff;
      border-radius: 12px;
      color: #fff;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .lang-btn:hover {
      background: rgba(0, 150, 255, 0.3);
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(0, 150, 255, 0.3);
    }

    .lang-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s ease;
    }

    .lang-btn:hover::before {
      left: 100%;
    }

    /* Main Container */
    .main-container {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      opacity: 0;
      transition: opacity 0.5s ease-in;
    }

    .main-container.visible {
      opacity: 1;
    }

    .chat-wrapper {
      display: flex;
      gap: 40px;
      align-items: center;
      max-width: 1200px;
      width: 100%;
    }

    /* 3D Robot Container */
    .robot-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #robot-container {
      width: 350px;
      height: 350px;
      border-radius: 20px;
      background: rgba(0, 150, 255, 0.1);
      border: 2px solid rgba(0, 150, 255, 0.3);
      box-shadow: 
        0 0 30px rgba(0, 150, 255, 0.3),
        inset 0 0 30px rgba(0, 150, 255, 0.1);
      position: relative;
      overflow: hidden;
    }

    #robot-canvas {
      width: 100%;
      height: 100%;
    }

    .robot-status {
      margin-top: 15px;
      padding: 8px 16px;
      background: rgba(0, 255, 0, 0.1);
      border: 1px solid rgba(0, 255, 0, 0.3);
      border-radius: 20px;
      font-size: 14px;
      color: #00ff00;
    }

    /* Chat Section */
    .chat-section {
      flex: 1;
      max-width: 500px;
    }

    .chat-container {
      height: 600px;
      display: flex;
      flex-direction: column;
      background: rgba(0, 20, 40, 0.8);
      border: 2px solid rgba(0, 150, 255, 0.3);
      border-radius: 20px;
      backdrop-filter: blur(20px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
      overflow: hidden;
    }

    .chat-header {
      padding: 20px;
      background: linear-gradient(135deg, rgba(0, 150, 255, 0.2), rgba(0, 255, 150, 0.2));
      border-bottom: 1px solid rgba(0, 150, 255, 0.3);
      text-align: center;
    }

    .chat-title {
      font-size: 24px;
      margin-bottom: 5px;
      background: linear-gradient(45deg, #0096ff, #00ff96);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .chat-subtitle {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.7);
    }

    #chat-box {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      scrollbar-width: thin;
      scrollbar-color: #0096ff rgba(255, 255, 255, 0.1);
    }

    #chat-box::-webkit-scrollbar {
      width: 6px;
    }

    #chat-box::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
    }

    #chat-box::-webkit-scrollbar-thumb {
      background: #0096ff;
      border-radius: 3px;
    }

    .message {
      margin: 10px 0;
      padding: 12px 16px;
      border-radius: 18px;
      max-width: 85%;
      word-wrap: break-word;
      animation: messageSlide 0.3s ease-out;
    }

    @keyframes messageSlide {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .user {
      background: linear-gradient(135deg, #0096ff, #0078d4);
      margin-left: auto;
      color: white;
      box-shadow: 0 4px 15px rgba(0, 150, 255, 0.3);
    }

    .bot {
      background: rgba(40, 40, 40, 0.9);
      border: 1px solid rgba(0, 150, 255, 0.2);
      margin-right: auto;
      color: #fff;
    }

    .typing-indicator {
      display: flex;
      align-items: center;
      gap: 5px;
      color: #0096ff;
    }

    .typing-dot {
      width: 6px;
      height: 6px;
      background: #0096ff;
      border-radius: 50%;
      animation: typingBounce 1.4s ease-in-out infinite both;
    }

    .typing-dot:nth-child(2) { animation-delay: -0.32s; }
    .typing-dot:nth-child(3) { animation-delay: -0.16s; }

    @keyframes typingBounce {
      0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
      40% { transform: scale(1.2); opacity: 1; }
    }

    /* Suggestions */
    .suggestions {
      padding: 15px;
      border-top: 1px solid rgba(0, 150, 255, 0.2);
    }

    .suggestions-title {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.6);
      margin-bottom: 8px;
    }

    .suggestion-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .suggestion-chip {
      padding: 6px 12px;
      background: rgba(0, 150, 255, 0.1);
      border: 1px solid rgba(0, 150, 255, 0.3);
      border-radius: 16px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .suggestion-chip:hover {
      background: rgba(0, 150, 255, 0.2);
      transform: translateY(-1px);
    }

    /* Input Section */
    .input-section {
      padding: 20px;
      background: rgba(0, 30, 60, 0.5);
      border-top: 1px solid rgba(0, 150, 255, 0.3);
    }

    .input-box {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    #user-input {
      flex: 1;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(0, 150, 255, 0.3);
      border-radius: 25px;
      color: #fff;
      font-size: 14px;
      outline: none;
      transition: all 0.3s ease;
    }

    #user-input:focus {
      border-color: #0096ff;
      box-shadow: 0 0 15px rgba(0, 150, 255, 0.3);
    }

    #user-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .send-btn {
      width: 45px;
      height: 45px;
      background: linear-gradient(135deg, #0096ff, #00ff96);
      border: none;
      border-radius: 50%;
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }

    .send-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 5px 20px rgba(0, 150, 255, 0.4);
    }

    .send-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    /* Greeting Message */
    .greeting {
      text-align: center;
      padding: 20px;
      background: rgba(0, 150, 255, 0.1);
      border: 1px solid rgba(0, 150, 255, 0.2);
      border-radius: 12px;
      margin-bottom: 15px;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .chat-wrapper {
        flex-direction: column;
        gap: 20px;
      }
      
      #robot-container {
        width: 280px;
        height: 280px;
      }
      
      .chat-container {
        height: 500px;
        max-width: 100%;
      }
      
      .lang-buttons {
        grid-template-columns: 1fr;
        max-width: 300px;
      }
    }
  </style>
</head>
<body>
  <!-- Animated Background -->
  <div class="bg-animation"></div>

  <!-- Preloader -->
  <div class="preloader" id="preloader">
    <div class="loader-circle"></div>
    <div class="loader-text">Initializing JARVIS...</div>
  </div>

  <!-- Language Selection -->
  <div class="language-selection" id="languageSelection">
    <h2 class="lang-title">Select Your Language</h2>
    <div class="lang-buttons">
      <button class="lang-btn" onclick="selectLanguage('en', 'English')">🇺🇸 English</button>
      <button class="lang-btn" onclick="selectLanguage('hi', 'हिंदी')">🇮🇳 हिंदी (Hindi)</button>
      <button class="lang-btn" onclick="selectLanguage('ta', 'தமிழ்')">🇮🇳 தமிழ் (Tamil)</button>
      <button class="lang-btn" onclick="selectLanguage('ja', '日本語')">🇯🇵 日本語 (Japanese)</button>
      <button class="lang-btn" onclick="selectLanguage('fr', 'Français')">🇫🇷 Français (French)</button>
    </div>
  </div>

  <!-- Main Container -->
  <div class="main-container" id="mainContainer">
    <div class="chat-wrapper">
      <!-- 3D Robot Section -->
      <div class="robot-section">
        <div id="robot-container">
          <canvas id="robot-canvas"></canvas>
        </div>
        <div class="robot-status">🟢 JARVIS Online</div>
      </div>

      <!-- Chat Section -->
      <div class="chat-section">
        <div class="chat-container">
          <div class="chat-header">
            <h1 class="chat-title">JARVIS AI Assistant</h1>
            <div class="chat-subtitle">Just A Rather Very Intelligent System</div>
          </div>
          
          <div id="chat-box">
            <div class="greeting" id="greetingMessage">
              Welcome! I'm JARVIS, your AI assistant. How may I help you today?
            </div>
          </div>

          <div class="suggestions">
            <div class="suggestions-title">Quick suggestions:</div>
            <div class="suggestion-chips">
              <span class="suggestion-chip" onclick="sendSuggestion('What can you help me with?')">What can you do?</span>
              <span class="suggestion-chip" onclick="sendSuggestion('Tell me a joke')">Tell me a joke</span>
              <span class="suggestion-chip" onclick="sendSuggestion('What is AI?')">What is AI?</span>
              <span class="suggestion-chip" onclick="sendSuggestion('Help me with coding')">Coding help</span>
            </div>
          </div>

          <div class="input-section">
            <div class="input-box">
              <input type="text" id="user-input" placeholder="Ask JARVIS anything..." onkeypress="handleKeyPress(event)" />
              <button class="send-btn" onclick="sendMessage()" id="sendBtn">➤</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  
  <script>
    let selectedLanguage = 'en';
    let isTyping = false;

    // Language data
    const languages = {
      en: {
        greeting: "Welcome! I'm JARVIS, your AI assistant. How may I help you today?",
        placeholder: "Ask JARVIS anything...",
        suggestions: [
          "What can you do?",
          "Tell me a joke", 
          "What is AI?",
          "Coding help"
        ]
      },
      hi: {
        greeting: "स्वागत है! मैं JARVIS हूँ, आपका AI सहायक। मैं आपकी कैसे सहायता कर सकता हूँ?",
        placeholder: "JARVIS से कुछ भी पूछें...",
        suggestions: [
          "आप क्या कर सकते हैं?",
          "मुझे एक जोक सुनाओ",
          "AI क्या है?", 
          "कोडिंग में मदद"
        ]
      },
      ta: {
        greeting: "வரவேற்கிறோம்! நான் JARVIS, உங்கள் AI உதவியாளர். இன்று நான் உங்களுக்கு எப்படி உதவ முடியும்?",
        placeholder: "JARVIS-இடம் எதையும் கேளுங்கள்...",
        suggestions: [
          "நீங்கள் என்ன செய்ய முடியும்?",
          "ஒரு நகைச்சுவை சொல்லுங்கள்",
          "AI என்றால் என்ன?",
          "கோடிங் உதவி"
        ]
      },
      ja: {
        greeting: "いらっしゃいませ！私はJARVIS、あなたのAIアシスタントです。今日はどのようにお手伝いできますか？",
        placeholder: "JARVISに何でも聞いてください...",
        suggestions: [
          "何ができますか？",
          "ジョークを聞かせて",
          "AIとは何ですか？",
          "コーディングのヘルプ"
        ]
      },
      fr: {
        greeting: "Bienvenue ! Je suis JARVIS, votre assistant IA. Comment puis-je vous aider aujourd'hui ?",
        placeholder: "Demandez tout à JARVIS...",
        suggestions: [
          "Que pouvez-vous faire ?",
          "Racontez-moi une blague",
          "Qu'est-ce que l'IA ?",
          "Aide au codage"
        ]
      }
    };

    // Initialize
    window.addEventListener('load', function() {
      setTimeout(() => {
        document.getElementById('preloader').classList.add('hidden');
      }, 2000);
    });

    // Language selection
    function selectLanguage(langCode, langName) {
      selectedLanguage = langCode;
      updateLanguage();
      document.getElementById('languageSelection').classList.add('hidden');
      document.getElementById('mainContainer').classList.add('visible');
    }

    function updateLanguage() {
      const lang = languages[selectedLanguage];
      document.getElementById('greetingMessage').textContent = lang.greeting;
      document.getElementById('user-input').placeholder = lang.placeholder;
      
      // Update suggestions
      const suggestionChips = document.querySelectorAll('.suggestion-chip');
      suggestionChips.forEach((chip, index) => {
        if (lang.suggestions[index]) {
          chip.textContent = lang.suggestions[index];
          chip.onclick = () => sendSuggestion(lang.suggestions[index]);
        }
      });
    }

    // Chat functionality
    async function sendMessage() {
      const input = document.getElementById('user-input');
      const message = input.value.trim();
      if (!message || isTyping) return;

      appendMessage('user', message);
      input.value = '';
      document.getElementById('sendBtn').disabled = true;

      showTypingIndicator();
      isTyping = true;

      try {
        // Simulate API call with timeout for demo
        await new Promise(resolve => setTimeout(resolve, 1500));
        
        // Remove typing indicator
        removeTypingIndicator();
        
        // Generate response based on language
        let response = generateResponse(message, selectedLanguage);
        appendMessage('bot', response);

      } catch (err) {
        removeTypingIndicator();
        appendMessage('bot', 'Sorry, I encountered an error. Please try again.');
      } finally {
        isTyping = false;
        document.getElementById('sendBtn').disabled = false;
      }
    }

    function generateResponse(message, lang) {
      const responses = {
        en: [
          "I understand your question. Let me help you with that.",
          "That's an interesting point. Here's what I think...",
          "Based on my analysis, I can suggest the following...",
          "I'm here to assist you. Let me provide some insights."
        ],
        hi: [
          "मैं आपका सवाल समझ गया। मैं इसमें आपकी मदद कर सकता हूँ।",
          "यह एक दिलचस्प बात है। मेरा मानना है कि...",
          "मेरे विश्लेषण के आधार पर, मैं निम्नलिखित सुझा सकता हूँ..."
        ],
        ta: [
          "உங்கள் கேள்வியை நான் புரிந்துகொண்டேன். நான் உங்களுக்கு உதவ முடியும்.",
          "இது ஒரு சுவாரஸ்யமான விஷயம். என் கருத்து என்னவென்றால்..."
        ],
        ja: [
          "ご質問を理解いたしました。お手伝いさせていただきます。",
          "興味深い点ですね。私の考えは次の通りです..."
        ],
        fr: [
          "Je comprends votre question. Laissez-moi vous aider avec cela.",
          "C'est un point intéressant. Voici ce que je pense..."
        ]
      };

      const langResponses = responses[lang] || responses.en;
      return langResponses[Math.floor(Math.random() * langResponses.length)];
    }

    function sendSuggestion(text) {
      document.getElementById('user-input').value = text;
      sendMessage();
    }

    function appendMessage(sender, text) {
      const chatBox = document.getElementById('chat-box');
      const msg = document.createElement('div');
      msg.className = `message ${sender}`;
      msg.textContent = text;
      chatBox.appendChild(msg);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    function showTypingIndicator() {
      const chatBox = document.getElementById('chat-box');
      const typing = document.createElement('div');
      typing.className = 'message bot typing-indicator';
      typing.id = 'typing-indicator';
      typing.innerHTML = `
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
      `;
      chatBox.appendChild(typing);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    function removeTypingIndicator() {
      const typing = document.getElementById('typing-indicator');
      if (typing) typing.remove();
    }

    function handleKeyPress(event) {
      if (event.key === 'Enter') {
        sendMessage();
      }
    }

    // 3D Robot Animation
    const canvas = document.getElementById('robot-canvas');
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(50, 1, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
    renderer.setSize(350, 350);
    renderer.setClearColor(0x000000, 0);

    // Create advanced robot
    const robotGroup = new THREE.Group();

    // Main body (sphere with glow)
    const bodyGeometry = new THREE.SphereGeometry(0.8, 32, 32);
    const bodyMaterial = new THREE.MeshPhongMaterial({ 
      color: 0x0096ff,
      shininess: 100,
      transparent: true,
      opacity: 0.9
    });
    const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
    robotGroup.add(body);

    // Head ring
    const ringGeometry = new THREE.TorusGeometry(1.2, 0.1, 8, 32);
    const ringMaterial = new THREE.MeshPhongMaterial({ color: 0x00ff96 });
    const headRing = new THREE.Mesh(ringGeometry, ringMaterial);
    headRing.position.y = 0.5;
    robotGroup.add(headRing);

    // Eyes
    const eyeGeometry = new THREE.SphereGeometry(0.12, 16, 16);
    const eyeMaterial = new THREE.MeshPhongMaterial({ 
      color: 0xffffff,
      emissive: 0x0096ff,
      emissiveIntensity: 0.3
    });
    
    const leftEye = new THREE.Mesh(eyeGeometry, eyeMaterial);
    leftEye.position.set(-0.3, 0.2, 0.7);
    const rightEye = new THREE.Mesh(eyeGeometry, eyeMaterial);
    rightEye.position.set(0.3, 0.2, 0.7);
    robotGroup.add(leftEye, rightEye);

    // Floating particles
    const particlesGeometry = new THREE.BufferGeometry();
    const particleCount = 50;
    const positions = new Float32Array(particleCount * 3);

    for (let i = 0; i < particleCount * 3; i++) {
      positions[i] = (Math.random() - 0.5) * 5;
    }

    particlesGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
    const particlesMaterial = new THREE.PointsMaterial({
      color: 0x0096ff,
      size: 0.02,
      transparent: true,
      opacity: 0.6
    });
    
    const particles = new THREE.Points(particlesGeometry, particlesMaterial);
    scene.add(particles);

    scene.add(robotGroup);

    // Enhanced lighting
    const ambientLight = new THREE.AmbientLight(0x404040, 0.3);
    scene.add(ambientLight);

    const pointLight1 = new THREE.PointLight(0x0096ff, 1, 100);
    pointLight1.position.set(2, 2, 2);
    scene.add(pointLight1);

    const pointLight2 = new THREE.PointLight(0x00ff96, 0.8, 100);
    pointLight2.position.set(-2, -1, 2);
    scene.add(pointLight2);

    camera.position.z = 4;

    // Enhanced animation
    let time = 0;
    function animate() {
      requestAnimationFrame(animate);
      time += 0.01;

      // Robot rotation and floating
      robotGroup.rotation.y += 0.005;
      robotGroup.position.y = Math.sin(time) * 0.1;

      // Ring rotation
      headRing.rotation.z += 0.02;

      // Eye glow animation
      const glowIntensity = (Math.sin(time * 2) + 1) * 0.2;
      leftEye.material.emissiveIntensity = glowIntensity;
      rightEye.material.emissiveIntensity = glowIntensity;

      // Particle animation
      particles.rotation.y += 0.001;
      
      // Light movement
      pointLight1.position.x = Math.cos(time) * 3;
      pointLight1.position.z = Math.sin(time) * 3;

      renderer.render(scene, camera);
    }

    animate();

    // Handle window resize
    window.addEventListener('resize', function() {
      const container = document.getElementById('robot-container');
      const width = container.clientWidth;
      const height = container.clientHeight;
      
      camera.aspect = width / height;
      camera.updateProjectionMatrix();
      renderer.setSize(width, height);
    });

    // Voice recognition (optional enhancement)
    let recognition;
    if ('webkitSpeechRecognition' in window) {
      recognition = new webkitSpeechRecognition();
      recognition.continuous = false;
      recognition.interimResults = false;
      recognition.lang = selectedLanguage === 'en' ? 'en-US' : 
                        selectedLanguage === 'hi' ? 'hi-IN' :
                        selectedLanguage === 'ta' ? 'ta-IN' :
                        selectedLanguage === 'ja' ? 'ja-JP' :
                        selectedLanguage === 'fr' ? 'fr-FR' : 'en-US';

      recognition.onresult = function(event) {
        const transcript = event.results[0][0].transcript;
        document.getElementById('user-input').value = transcript;
        sendMessage();
      };
    }

    // Add voice input button (if supported)
    if (recognition) {
      const voiceBtn = document.createElement('button');
      voiceBtn.innerHTML = '🎤';
      voiceBtn.className = 'send-btn';
      voiceBtn.style.marginRight = '5px';
      voiceBtn.onclick = function() {
        recognition.start();
        voiceBtn.innerHTML = '🎙️';
        setTimeout(() => {
          voiceBtn.innerHTML = '🎤';
        }, 3000);
      };
      
      document.querySelector('.input-box').insertBefore(voiceBtn, document.getElementById('sendBtn'));
    }

    // Add some interactive features
    document.addEventListener('click', function(e) {
      // Add click ripple effect
      if (e.target.classList.contains('lang-btn') || e.target.classList.contains('suggestion-chip')) {
        const ripple = document.createElement('span');
        ripple.style.cssText = `
          position: absolute;
          border-radius: 50%;
          background: rgba(255, 255, 255, 0.3);
          transform: scale(0);
          animation: ripple 0.6s linear;
          pointer-events: none;
        `;
        
        const rect = e.target.getBoundingClientRect();
        const size = Math.max(rect.width, rect.height);
        ripple.style.width = ripple.style.height = size + 'px';
        ripple.style.left = (e.clientX - rect.left - size / 2) + 'px';
        ripple.style.top = (e.clientY - rect.top - size / 2) + 'px';
        
        e.target.style.position = 'relative';
        e.target.appendChild(ripple);
        
        setTimeout(() => ripple.remove(), 600);
      }
    });

    // Add CSS for ripple animation
    const style = document.createElement('style');
    style.textContent = `
      @keyframes ripple {
        to {
          transform: scale(4);
          opacity: 0;
        }
      }
      
      /* Additional animations */
      @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
      }
      
      .robot-status {
        animation: float 3s ease-in-out infinite;
      }
      
      /* Holographic effect for robot container */
      #robot-container::before {
        content: '';
        position: absolute;
        top: -2px;
        left: -2px;
        right: -2px;
        bottom: -2px;
        background: linear-gradient(45deg, #0096ff, #00ff96, #ff0096, #0096ff);
        border-radius: 22px;
        z-index: -1;
        animation: borderGlow 3s linear infinite;
        background-size: 300% 300%;
      }
      
      @keyframes borderGlow {
        0%, 100% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
      }
      
      /* Enhanced message animations */
      .message.user {
        animation: slideInRight 0.3s ease-out, glow 0.5s ease-in-out;
      }
      
      .message.bot {
        animation: slideInLeft 0.3s ease-out;
      }
      
      @keyframes slideInRight {
        from { 
          opacity: 0; 
          transform: translateX(30px); 
        }
        to { 
          opacity: 1; 
          transform: translateX(0); 
        }
      }
      
      @keyframes slideInLeft {
        from { 
          opacity: 0; 
          transform: translateX(-30px); 
        }
        to { 
          opacity: 1; 
          transform: translateX(0); 
        }
      }
      
      @keyframes glow {
        0%, 100% { box-shadow: 0 4px 15px rgba(0, 150, 255, 0.3); }
        50% { box-shadow: 0 4px 25px rgba(0, 150, 255, 0.6); }
      }
      
      /* Improved scrollbar for webkit browsers */
      #chat-box::-webkit-scrollbar-thumb:hover {
        background: #00ff96;
      }
      
      /* Loading states */
      .send-btn.loading {
        animation: spin 1s linear infinite;
      }
      
      /* Dark mode enhancements */
      .chat-container {
        box-shadow: 
          0 15px 35px rgba(0, 0, 0, 0.3),
          0 0 0 1px rgba(0, 150, 255, 0.1),
          inset 0 1px 0 rgba(255, 255, 255, 0.1);
      }
      
      /* Improved mobile responsiveness */
      @media (max-width: 480px) {
        .chat-wrapper {
          padding: 10px;
        }
        
        .chat-container {
          height: 70vh;
        }
        
        #robot-container {
          width: 250px;
          height: 250px;
        }
        
        .lang-title {
          font-size: 24px;
        }
        
        .message {
          max-width: 95%;
        }
      }
    `;
    document.head.appendChild(style);

    // Enhanced error handling and reconnection logic
    let reconnectAttempts = 0;
    const maxReconnectAttempts = 3;

    async function handleApiCall(message) {
      try {
        const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
          method: "POST",
          headers: {
            "Authorization": "Bearer YOUR-API-KEY",
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            model: "mistralai/mistral-small-3.2-24b-instruct:free",
            messages: [{ 
              role: "user", 
              content: `Respond in ${selectedLanguage === 'en' ? 'English' : 
                                   selectedLanguage === 'hi' ? 'Hindi' :
                                   selectedLanguage === 'ta' ? 'Tamil' :
                                   selectedLanguage === 'ja' ? 'Japanese' :
                                   selectedLanguage === 'fr' ? 'French' : 'English'}: ${message}` 
            }]
          })
        });

        if (!response.ok) {
          throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }

        const data = await response.json();
        reconnectAttempts = 0; // Reset on success
        return data.choices?.[0]?.message?.content || generateResponse(message, selectedLanguage);

      } catch (error) {
        console.error('API Error:', error);
        
        if (reconnectAttempts < maxReconnectAttempts) {
          reconnectAttempts++;
          // Wait before retry
          await new Promise(resolve => setTimeout(resolve, 1000 * reconnectAttempts));
          return await handleApiCall(message);
        }
        
        // Fallback to local response
        return generateResponse(message, selectedLanguage);
      }
    }

    // Update the sendMessage function to use the new API handler
    async function sendMessage() {
      const input = document.getElementById('user-input');
      const message = input.value.trim();
      if (!message || isTyping) return;

      appendMessage('user', message);
      input.value = '';
      document.getElementById('sendBtn').disabled = true;
      document.getElementById('sendBtn').classList.add('loading');

      showTypingIndicator();
      isTyping = true;

      try {
        const response = await handleApiCall(message);
        removeTypingIndicator();
        appendMessage('bot', response);
        
        // Update robot animation based on response
        animateRobotResponse();

      } catch (err) {
        removeTypingIndicator();
        const errorMsg = selectedLanguage === 'hi' ? 'खुशी से, मैं एक त्रुटि का सामना कर रहा हूँ। कृपया पुनः प्रयास करें।' :
                        selectedLanguage === 'ta' ? 'மன்னிக்கவும், நான் ஒரு பிழையை எதிர்கொண்டேன். தயவுசெய்து மீண்டும் முயற்சிக்கவும்.' :
                        selectedLanguage === 'ja' ? 'すみません、エラーが発生しました。もう一度お試しください。' :
                        selectedLanguage === 'fr' ? 'Désolé, j\'ai rencontré une erreur. Veuillez réessayer.' :
                        'Sorry, I encountered an error. Please try again.';
        appendMessage('bot', errorMsg);
      } finally {
        isTyping = false;
        document.getElementById('sendBtn').disabled = false;
        document.getElementById('sendBtn').classList.remove('loading');
      }
    }

    // Robot response animation
    function animateRobotResponse() {
      // Make robot "talk" by scaling slightly
      const originalScale = robotGroup.scale.clone();
      robotGroup.scale.multiplyScalar(1.1);
      
      setTimeout(() => {
        robotGroup.scale.copy(originalScale);
      }, 500);
      
      // Flash the eyes
      leftEye.material.emissiveIntensity = 1;
      rightEye.material.emissiveIntensity = 1;
      
      setTimeout(() => {
        leftEye.material.emissiveIntensity = 0.3;
        rightEye.material.emissiveIntensity = 0.3;
      }, 200);
    }

    // Initialize the application
    console.log('🤖 JARVIS AI Assistant Initialized');
    console.log('🌟 Features: 3D Animation, Multi-language, Voice Input, Suggestions');
  </script>
</body>
</html>